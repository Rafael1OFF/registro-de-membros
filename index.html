<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro de Membros - Comunidade Família Cristã</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
    }
    header {
      background: #003366;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    input, select, button, textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background: #003366;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #0055aa;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: left;
    }
    .login {
      max-width: 400px;
      margin: 100px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    .hidden {
      display: none !important;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      width: 100%;
      box-sizing: border-box;
    }
    .btn-small {
      width: auto;
      padding: 5px 10px;
      margin-right: 5px;
      font-size: 0.9em;
      display: inline-block;
    }
  </style>
</head>
<body>

<header>
  <h1>Cadastro de Membros</h1>
  <p>Comunidade Família Cristã</p>
</header>

<div class="login" id="loginBox">
  <h2>Login de Administrador</h2>
  <input type="text" id="user" placeholder="Usuário" />
  <input type="password" id="pass" placeholder="Senha" />
  <button onclick="login()">Entrar</button>
</div>

<div class="container hidden" id="painel">
  <h2>Registrar Novo Membro</h2>
  <input type="text" id="nome" placeholder="Nome Completo" required />
  <input type="number" id="idade" placeholder="Idade" required />
  <input type="email" id="email" placeholder="E-mail" required />
  <input type="text" id="telefone" placeholder="Telefone principal" required />
  <input type="text" id="telefone2" placeholder="Outro telefone (opcional)" />
  <input type="text" id="nomePai" placeholder="Nome do Pai" />
  <input type="text" id="nomeMae" placeholder="Nome da Mãe" />
  <input type="text" id="escolaridade" placeholder="Escolaridade" />
  <input type="text" id="endereco" placeholder="Endereço" />
  <input type="text" id="tempoIgreja" placeholder="Há quanto tempo está na igreja?" />
  <select id="batizado">
    <option value="Sim">Sim, sou batizado</option>
    <option value="Não">Não sou batizado</option>
  </select>
  <label for="trabalha">Você trabalha?</label>
  <select id="trabalha" onchange="verificarTrabalho()">
    <option value="Sim">Sim</option>
    <option value="Não">Ainda não</option>
  </select>
  <input type="text" id="profissao" placeholder="Em que trabalha?" />
  <select id="funcao" onchange="verificarOutraFuncao()">
    <option value="Pastor Principal">Pastor Principal</option>
    <option value="Pastores à disposição">Pastores à disposição</option>
    <option value="Líder de Intercessão">Líder de Intercessão</option>
    <option value="Líderes de Células">Líderes de Células</option>
    <option value="Ministério de Louvor">Ministério de Louvor</option>
    <option value="Dança">Dança</option>
    <option value="Responsável Técnico da Mesa de Som">Responsável Técnico da Mesa de Som</option>
    <option value="Líder do Marketing">Líder do Marketing</option>
    <option value="Membro do Marketing">Membro do Marketing</option>
    <option value="Sala das Crianças">Sala das Crianças</option>
    <option value="Ainda não tenho nenhuma função">Ainda não tenho nenhuma função</option>
  </select>
  <textarea id="almejaFuncao" class="hidden" placeholder="Se você almeja alguma função, descreva aqui"></textarea>
  <button onclick="adicionarMembro()">Cadastrar Membro</button>

  <h2>Lista de Membros</h2>
  <table>
    <thead>
      <tr>
        <th>Nome</th>
        <th>Telefone</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody id="tabelaMembros"></tbody>
  </table>
  <br />
  <button onclick="logout()">Sair</button>
</div>

<div id="modal" class="modal hidden" style="z-index: 999;">
  <div class="modal-content" id="modalContent"></div>
</div>

<script>
  let membros = JSON.parse(localStorage.getItem('membros') || '[]');

  function login() {
    const u = document.getElementById('user').value;
    const p = document.getElementById('pass').value;
    if (u === 'admin' && p === 'admin123') {
      document.getElementById('loginBox').classList.add('hidden');
      document.getElementById('painel').classList.remove('hidden');
      atualizarTabela();
    } else {
      alert('Login inválido');
    }
  }

  function logout() {
    document.getElementById('loginBox').classList.remove('hidden');
    document.getElementById('painel').classList.add('hidden');
  }

  function verificarOutraFuncao() {
    const funcao = document.getElementById('funcao').value;
    const campoExtra = document.getElementById('almejaFuncao');
    if (funcao === 'Ainda não tenho nenhuma função') {
      campoExtra.classList.remove('hidden');
    } else {
      campoExtra.classList.add('hidden');
      campoExtra.value = '';
    }
  }

  function verificarTrabalho() {
    const trabalha = document.getElementById('trabalha').value;
    const profissao = document.getElementById('profissao');
    if (trabalha === 'Sim') {
      profissao.classList.remove('hidden');
    } else {
      profissao.classList.add('hidden');
      profissao.value = '';
    }
  }

  // Inicializa o estado do campo profissão ao carregar
  window.onload = function () {
    verificarTrabalho();
  };

  function adicionarMembro() {
    const membro = {
      nome: document.getElementById('nome').value.trim(),
      idade: document.getElementById('idade').value,
      email: document.getElementById('email').value,
      telefone: document.getElementById('telefone').value,
      telefone2: document.getElementById('telefone2').value,
      nomePai: document.getElementById('nomePai').value,
      nomeMae: document.getElementById('nomeMae').value,
      escolaridade: document.getElementById('escolaridade').value,
      endereco: document.getElementById('endereco').value,
      tempoIgreja: document.getElementById('tempoIgreja').value,
      batizado: document.getElementById('batizado').value,
      trabalha: document.getElementById('trabalha').value,
      profissao: document.getElementById('profissao').value,
      funcao: document.getElementById('funcao').value,
      almejaFuncao: document.getElementById('almejaFuncao').value
    };

    if (membro.funcao === 'Ainda não tenho nenhuma função' && membro.almejaFuncao) {
      membro.funcao += ` (Deseja: ${membro.almejaFuncao})`;
    }

    if (!membro.nome || !membro.idade || !membro.email || !membro.telefone) {
      alert('Por favor, preencha os campos obrigatórios: Nome, Idade, E-mail e Telefone.');
      return;
    }

    membros.push(membro);
    localStorage.setItem('membros', JSON.stringify(membros));
    atualizarTabela();

    // Limpar campos
    document.querySelectorAll('input, textarea').forEach(e => e.value = '');
    document.getElementById('almejaFuncao').classList.add('hidden');
    verificarTrabalho();
  }

  function atualizarTabela() {
    const tabela = document.getElementById('tabelaMembros');
    tabela.innerHTML = '';
    membros.forEach((m, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><a href="#" onclick="mostrarDetalhes(${i})">${m.nome}</a></td>
        <td>${m.telefone}</td>
        <td>
          <button class="btn-small" onclick="editarMembro(${i})">Editar</button>
          <button class="btn-small" onclick="apagarMembro(${i})" style="background:#cc3333;">Apagar</button>
        </td>
      `;
      tabela.appendChild(tr);
    });
  }

  function mostrarDetalhes(i) {
    const m = membros[i];
    const modal = document.getElementById('modal');
    const content = document.getElementById('modalContent');
    content.innerHTML = `
      <h3>Informações de ${m.nome}</h3>
      <p><strong>Idade:</strong> ${m.idade}</p>
      <p><strong>Email:</strong> ${m.email}</p>
      <p><strong>Telefone:</strong> ${m.telefone}</p>
      <p><strong>Outro telefone:</strong> ${m.telefone2}</p>
      <p><strong>Nome do Pai:</strong> ${m.nomePai}</p>
      <p><strong>Nome da Mãe:</strong> ${m.nomeMae}</p>
      <p><strong>Escolaridade:</strong> ${m.escolaridade}</p>
      <p><strong>Endereço:</strong> ${m.endereco}</p>
      <p><strong>Tempo de igreja:</strong> ${m.tempoIgreja}</p>
      <p><strong>Batizado:</strong> ${m.batizado}</p>
      <p><strong>Trabalha:</strong> ${m.trabalha}</p>
      <p><strong>Profissão:</strong> ${m.profissao}</p>
      <p><strong>Função:</strong> ${m.funcao}</p>
      <button onclick="fecharModal()">Fechar</button>
    `;
    modal.classList.remove('hidden');
  }

  function fecharModal() {
    document.getElementById('modal').classList.add('hidden');
  }

  function editarMembro(i) {
    const m = membros[i];
    // Preenche o formulário com dados do membro para edição
    document.getElementById('nome').value = m.nome;
    document.getElementById('idade').value = m.idade;
    document.getElementById('email').value = m.email;
    document.getElementById('telefone').value = m.telefone;
    document.getElementById('telefone2').value = m.telefone2;
    document.getElementById('nomePai').value = m.nomePai;
    document.getElementById('nomeMae').value = m.nomeMae;
    document.getElementById('escolaridade').value = m.escolaridade;
    document.getElementById('endereco').value = m.endereco;
    document.getElementById('tempoIgreja').value = m.tempoIgreja;
    document.getElementById('batizado').value = m.batizado;
    document.getElementById('trabalha').value = m.trabalha;
    verificarTrabalho();
    document.getElementById('profissao').value = m.profissao;

    // Para função, trata o campo extra se houver
    if (m.funcao.includes('(Deseja:')) {
      document.getElementById('funcao').value = 'Ainda não tenho nenhuma função';
      document.getElementById('almejaFuncao').classList.remove('hidden');
      const extra = m.funcao.match(/\(Deseja: (.*)\)/);
      document.getElementById('almejaFuncao').value = extra ? extra[1] : '';
    } else {
      document.getElementById('funcao').value = m.funcao;
      document.getElementById('almejaFuncao').classList.add('hidden');
      document.getElementById('almejaFuncao').value = '';
    }

    // Remove o membro antigo e espera cadastro do atualizado
    membros.splice(i, 1);
    localStorage.setItem('membros', JSON.stringify(membros));
    atualizarTabela();

    // Foca o nome para facilitar edição
    document.getElementById('nome').focus();
  }

  function apagarMembro(i) {
    if (confirm(`Tem certeza que deseja apagar o membro "${membros[i].nome}"?`)) {
      membros.splice(i, 1);
      localStorage.setItem('membros', JSON.stringify(membros));
      atualizarTabela();
    }
  }
</script>

</body>
</html>
